<!DOCTYPE html>
<html>
<head>
    <title>ä¸­é”®æ‹–åŠ¨è°ƒè¯•é¡µé¢</title>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
        .debug-info {
            background: #f0f8ff;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #007bff;
        }
        .test-area {
            width: 800px;
            height: 400px;
            border: 3px solid #333;
            background: linear-gradient(45deg, #f9f9f9 25%, transparent 25%),
                        linear-gradient(-45deg, #f9f9f9 25%, transparent 25%),
                        linear-gradient(45deg, transparent 75%, #f9f9f9 75%),
                        linear-gradient(-45deg, transparent 75%, #f9f9f9 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            position: relative;
            cursor: grab;
            margin-bottom: 20px;
        }
        .test-area:active {
            cursor: grabbing;
        }
        .log-area {
            height: 300px;
            overflow-y: auto;
            background: #1e1e1e;
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
        .status {
            background: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            border: 1px solid #ffeaa7;
        }
        .clear-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-bottom: 10px;
        }
        .iframe-container {
            border: 2px solid #28a745;
            border-radius: 8px;
            overflow: hidden;
            height: 500px;
            margin-top: 20px;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>
<body>
    <div class="debug-info">
        <h2>ğŸ” ä¸­é”®æ‹–åŠ¨åŠŸèƒ½æ·±åº¦è°ƒè¯•</h2>
        <p><strong>æµ‹è¯•ç›®æ ‡:</strong> ç¡®å®šä¸­é”®æ‹–åŠ¨åŠŸèƒ½å¤±æ•ˆçš„æ ¹æœ¬åŸå› </p>
        <p><strong>æµè§ˆå™¨:</strong> <span id="browser-info"></span></p>
        <p><strong>æ“ä½œç³»ç»Ÿ:</strong> <span id="os-info"></span></p>
        <p><strong>æ—¶é—´æˆ³:</strong> <span id="timestamp"></span></p>
    </div>

    <div class="status">
        <h3>ğŸ“‹ æµ‹è¯•æ­¥éª¤:</h3>
        <ol>
            <li><strong>æ­¥éª¤1:</strong> åœ¨ä¸‹æ–¹ç°è‰²åŒºåŸŸæŒ‰ä½é¼ æ ‡ä¸­é”®æ‹–åŠ¨</li>
            <li><strong>æ­¥éª¤2:</strong> è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—è¾“å‡º</li>
            <li><strong>æ­¥éª¤3:</strong> åœ¨ä¸‹æ–¹TaskWallåº”ç”¨ä¸­æµ‹è¯•ä¸­é”®æ‹–åŠ¨</li>
            <li><strong>æ­¥éª¤4:</strong> å¯¹æ¯”ä¸¤ä¸ªæµ‹è¯•ç»“æœ</li>
        </ol>
    </div>

    <h3>ğŸ§ª åŸºç¡€ä¸­é”®æ‹–åŠ¨æµ‹è¯•</h3>
    <div class="test-area" id="testArea">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                    background: rgba(0,123,255,0.1); padding: 20px; border-radius: 10px; 
                    border: 2px dashed #007bff; text-align: center;">
            <h4>ğŸ¯ æµ‹è¯•åŒºåŸŸ</h4>
            <p>åœ¨è¿™é‡ŒæŒ‰ä½é¼ æ ‡ä¸­é”®æ‹–åŠ¨</p>
            <p>åº”è¯¥èƒ½çœ‹åˆ°è¯¦ç»†çš„äº‹ä»¶æ—¥å¿—</p>
        </div>
    </div>

    <button class="clear-btn" onclick="clearLog()">ğŸ—‘ï¸ æ¸…é™¤æ—¥å¿—</button>
    <div class="log-area" id="logArea"></div>

    <h3>ğŸ® TaskWallåº”ç”¨æµ‹è¯•</h3>
    <div class="iframe-container">
        <iframe src="http://localhost:3000" id="taskwallFrame"></iframe>
    </div>

    <script>
        let isPanning = false;
        let startX = 0;
        let startY = 0;
        let currentX = 0;
        let currentY = 0;
        
        const testArea = document.getElementById('testArea');
        const logArea = document.getElementById('logArea');
        
        // åˆå§‹åŒ–é¡µé¢ä¿¡æ¯
        document.getElementById('browser-info').textContent = navigator.userAgent;
        document.getElementById('os-info').textContent = navigator.platform;
        document.getElementById('timestamp').textContent = new Date().toLocaleString();
        
        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#ff6b6b' : 
                         type === 'success' ? '#51cf66' : 
                         type === 'warning' ? '#ffd43b' : '#74c0fc';
            
            logArea.innerHTML += `<span style="color: ${color}">[${timestamp}] ${message}</span>\n`;
            logArea.scrollTop = logArea.scrollHeight;
        }
        
        function clearLog() {
            logArea.innerHTML = '';
            addLog('ğŸ§¹ æ—¥å¿—å·²æ¸…é™¤', 'info');
        }
        
        // åˆå§‹åŒ–æ—¥å¿—
        addLog('ğŸš€ è°ƒè¯•é¡µé¢åˆå§‹åŒ–å®Œæˆ');
        addLog('ğŸ–±ï¸ è¯·åœ¨ä¸Šæ–¹æµ‹è¯•åŒºåŸŸä½¿ç”¨é¼ æ ‡ä¸­é”®æ‹–åŠ¨');
        
        // === æ ¸å¿ƒäº‹ä»¶ç›‘å¬ ===
        
        // 1. mousedown äº‹ä»¶
        testArea.addEventListener('mousedown', function(event) {
            addLog(`ğŸ¯ mousedown äº‹ä»¶: button=${event.button}, ä½ç½®=(${event.clientX}, ${event.clientY})`, 'info');
            
            if (event.button === 1) { // ä¸­é”®
                addLog('ğŸš€ ä¸­é”®æŒ‰ä¸‹ - å¼€å§‹æ‹–åŠ¨æµç¨‹', 'success');
                event.preventDefault();
                event.stopPropagation();
                
                isPanning = true;
                startX = event.clientX;
                startY = event.clientY;
                currentX = 0;
                currentY = 0;
                
                testArea.style.cursor = 'grabbing';
                document.body.style.userSelect = 'none';
                
                // ç»‘å®šå…¨å±€äº‹ä»¶
                document.addEventListener('mousemove', handleMouseMove, { passive: false, capture: true });
                document.addEventListener('mouseup', handleMouseUp, { passive: false, capture: true, once: true });
                
                addLog('âœ… äº‹ä»¶ç›‘å¬å™¨å·²ç»‘å®š', 'success');
            } else {
                addLog(`â„¹ï¸ å…¶ä»–æŒ‰é”®æŒ‰ä¸‹: button=${event.button}`, 'warning');
            }
        });
        
        // 2. auxclick äº‹ä»¶
        testArea.addEventListener('auxclick', function(event) {
            addLog(`ğŸ¯ auxclick äº‹ä»¶: button=${event.button}`, 'info');
            
            if (event.button === 1) {
                addLog('ğŸš« é˜»æ­¢ä¸­é”®é»˜è®¤è¡Œä¸º', 'warning');
                event.preventDefault();
                event.stopPropagation();
            }
        });
        
        // 3. contextmenu äº‹ä»¶
        testArea.addEventListener('contextmenu', function(event) {
            addLog('ğŸ¯ contextmenu äº‹ä»¶è§¦å‘', 'warning');
            event.preventDefault();
        });
        
        // 4. mousemove å¤„ç†å‡½æ•°
        function handleMouseMove(event) {
            if (!isPanning) return;
            
            event.preventDefault();
            
            const deltaX = event.clientX - startX;
            const deltaY = event.clientY - startY;
            
            currentX += deltaX * 0.1; // æ¨¡æ‹Ÿç”»å¸ƒç§»åŠ¨
            currentY += deltaY * 0.1;
            
            // æ›´æ–°è§†è§‰åé¦ˆ
            testArea.style.backgroundPosition = `${currentX}px ${currentY}px`;
            
            if (Math.random() < 0.3) { // å‡å°‘æ—¥å¿—é¢‘ç‡
                addLog(`ğŸ“Š æ‹–åŠ¨ä¸­: ä½ç§»=(${deltaX}, ${deltaY}), ç´¯è®¡=(${currentX.toFixed(1)}, ${currentY.toFixed(1)})`, 'info');
            }
        }
        
        // 5. mouseup å¤„ç†å‡½æ•°
        function handleMouseUp(event) {
            if (!isPanning) return;
            
            addLog('ğŸ›‘ ä¸­é”®æ‹–åŠ¨ç»“æŸ', 'success');
            addLog(`ğŸ“ˆ æœ€ç»ˆä½ç§»: (${currentX.toFixed(1)}, ${currentY.toFixed(1)})`, 'success');
            
            isPanning = false;
            testArea.style.cursor = 'grab';
            document.body.style.userSelect = '';
            
            // ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
            document.removeEventListener('mousemove', handleMouseMove, { capture: true });
            
            addLog('âœ… äº‹ä»¶ç›‘å¬å™¨å·²æ¸…ç†', 'success');
        }
        
        // === é¢å¤–çš„è°ƒè¯•ä¿¡æ¯ ===
        
        // æ£€æµ‹é¼ æ ‡èƒ½åŠ›
        addLog(`ğŸ–±ï¸ é¼ æ ‡æŒ‰é”®æ”¯æŒ: ${navigator.maxTouchPoints > 0 ? 'è§¦æ‘¸è®¾å¤‡' : 'é¼ æ ‡è®¾å¤‡'}`, 'info');
        
        // æ£€æµ‹äº‹ä»¶æ”¯æŒ
        const supportsAuxClick = 'onauxclick' in testArea;
        addLog(`ğŸ”§ auxclick äº‹ä»¶æ”¯æŒ: ${supportsAuxClick ? 'âœ…' : 'âŒ'}`, supportsAuxClick ? 'success' : 'error');
        
        // æ£€æµ‹æµè§ˆå™¨ç‰¹æ€§
        const isChrome = navigator.userAgent.includes('Chrome');
        const isFirefox = navigator.userAgent.includes('Firefox');
        const isSafari = navigator.userAgent.includes('Safari') && !isChrome;
        
        addLog(`ğŸŒ æµè§ˆå™¨ç±»å‹: ${isChrome ? 'Chrome' : isFirefox ? 'Firefox' : isSafari ? 'Safari' : 'å…¶ä»–'}`, 'info');
        
        // ç›‘å¬iframeåŠ è½½
        const iframe = document.getElementById('taskwallFrame');
        iframe.onload = function() {
            addLog('ğŸ® TaskWallåº”ç”¨å·²åŠ è½½å®Œæˆ', 'success');
            addLog('ğŸ’¡ ç°åœ¨å¯ä»¥åœ¨TaskWallåº”ç”¨ä¸­æµ‹è¯•ä¸­é”®æ‹–åŠ¨åŠŸèƒ½', 'info');
        };
        
        iframe.onerror = function() {
            addLog('âŒ TaskWallåº”ç”¨åŠ è½½å¤±è´¥', 'error');
        };
        
        // å…¨å±€é”™è¯¯æ•è·
        window.addEventListener('error', function(event) {
            addLog(`ğŸ’¥ JavaScripté”™è¯¯: ${event.message}`, 'error');
        });
        
        addLog('ğŸ” æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨å·²è®¾ç½®å®Œæˆ', 'success');
        addLog('ğŸ“‹ è¯·å¼€å§‹æµ‹è¯•...', 'info');
    </script>
</body>
</html>