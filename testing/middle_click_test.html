<!DOCTYPE html>
<html>
<head>
    <title>ä¸­é”®æ‹–åŠ¨æµ‹è¯•</title>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
        .test-container {
            width: 600px;
            height: 400px;
            border: 2px solid #666;
            position: relative;
            cursor: grab;
            background: #f5f5f5;
            overflow: hidden;
        }
        .test-container:active {
            cursor: grabbing;
        }
        .content {
            width: 200px;
            height: 200px;
            background: #4CAF50;
            position: absolute;
            top: 100px;
            left: 200px;
            transform-origin: 0 0;
            transition: transform 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        .info {
            margin-bottom: 20px;
            padding: 10px;
            background: #e3f2fd;
            border-radius: 5px;
        }
        .log {
            margin-top: 20px;
            padding: 10px;
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 5px;
            height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="info">
        <h3>ä¸­é”®æ‹–åŠ¨åŠŸèƒ½æµ‹è¯•</h3>
        <p>è¯·ä½¿ç”¨é¼ æ ‡ä¸­é”®ï¼ˆæ»šè½®æŒ‰ä¸‹ï¼‰åœ¨ä¸‹æ–¹åŒºåŸŸæ‹–åŠ¨ç»¿è‰²æ–¹å—</p>
        <p>å¦‚æœåŠŸèƒ½æ­£å¸¸ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„æ‹–åŠ¨æ—¥å¿—</p>
    </div>
    
    <div class="test-container" id="container">
        <div class="content" id="content">æ‹–åŠ¨æµ‹è¯•åŒºåŸŸ</div>
    </div>
    
    <div class="log" id="log"></div>

    <script>
        const container = document.getElementById('container');
        const content = document.getElementById('content');
        const log = document.getElementById('log');
        
        let isPanning = false;
        let startX = 0;
        let startY = 0;
        let startTransformX = 0;
        let startTransformY = 0;
        let currentTransformX = 0;
        let currentTransformY = 0;
        
        function addLog(message) {
            const time = new Date().toLocaleTimeString();
            log.innerHTML += `[${time}] ${message}\n`;
            log.scrollTop = log.scrollHeight;
        }
        
        // ç›‘å¬é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶
        container.addEventListener('mousedown', function(event) {
            addLog(`ğŸ¯ é¼ æ ‡æŒ‰ä¸‹: æŒ‰é”®=${event.button}, ä½ç½®=(${event.clientX}, ${event.clientY})`);
            
            // åªå¤„ç†ä¸­é”®
            if (event.button === 1) {
                event.preventDefault();
                event.stopPropagation();
                
                isPanning = true;
                startX = event.clientX;
                startY = event.clientY;
                startTransformX = currentTransformX;
                startTransformY = currentTransformY;
                
                addLog('ğŸš€ å¼€å§‹ä¸­é”®æ‹–åŠ¨');
                
                document.addEventListener('mousemove', handleMouseMove, { passive: false, capture: true });
                document.addEventListener('mouseup', handleMouseUp, { passive: false, capture: true, once: true });
                document.addEventListener('mouseleave', handleMouseUp, { passive: false, capture: true, once: true });
            }
        });
        
        function handleMouseMove(event) {
            if (!isPanning) return;
            
            event.preventDefault();
            
            const deltaX = event.clientX - startX;
            const deltaY = event.clientY - startY;
            
            currentTransformX = startTransformX + deltaX;
            currentTransformY = startTransformY + deltaY;
            
            content.style.transform = `translate3d(${currentTransformX}px, ${currentTransformY}px, 0)`;
            
            if (Math.random() < 0.1) { // 10%æ¦‚ç‡è¾“å‡ºï¼Œé¿å…è¿‡å¤šæ—¥å¿—
                addLog(`ğŸ“Š æ‹–åŠ¨ä¸­: ä½ç§»=(${deltaX}, ${deltaY}), æœ€ç»ˆä½ç½®=(${currentTransformX}, ${currentTransformY})`);
            }
        }
        
        function handleMouseUp() {
            if (!isPanning) return;
            
            isPanning = false;
            addLog(`ğŸ›‘ æ‹–åŠ¨ç»“æŸ: æœ€ç»ˆä½ç½®=(${currentTransformX}, ${currentTransformY})`);
            
            document.removeEventListener('mousemove', handleMouseMove, { capture: true });
        }
        
        // é˜²æ­¢æµè§ˆå™¨é»˜è®¤çš„ä¸­é”®è¡Œä¸º
        container.addEventListener('contextmenu', function(event) {
            event.preventDefault();
        });
        
        container.addEventListener('auxclick', function(event) {
            if (event.button === 1) {
                event.preventDefault();
            }
        });
        
        addLog('âœ… æµ‹è¯•é¡µé¢åˆå§‹åŒ–å®Œæˆï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•ä¸­é”®æ‹–åŠ¨');
    </script>
</body>
</html>