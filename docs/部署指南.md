# TaskWall v2.0 éƒ¨ç½²æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šè‡ªåŠ¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•
cd /Users/hao/project/RENWU

# è¿è¡Œè‡ªåŠ¨å¯åŠ¨è„šæœ¬
./start.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- åˆ›å»ºPythonè™šæ‹Ÿç¯å¢ƒ
- å®‰è£…æ‰€æœ‰ä¾èµ–
- å¯åŠ¨åç«¯APIæœåŠ¡å™¨ (ç«¯å£8000)
- å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ (ç«¯å£5173)

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

#### 1. ç¯å¢ƒå‡†å¤‡

**ç³»ç»Ÿè¦æ±‚**:
- Python 3.8+
- Node.js 16+
- npm æˆ– yarn

**ä¾èµ–å®‰è£…**:
```bash
# åç«¯ä¾èµ–
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt

# å‰ç«¯ä¾èµ–
cd ../frontend
npm install
```

#### 2. å¯åŠ¨æœåŠ¡

**åç«¯æœåŠ¡**:
```bash
cd backend
source venv/bin/activate
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

**å‰ç«¯æœåŠ¡**:
```bash
cd frontend
npm run dev
```

### æ–¹å¼ä¸‰ï¼šDockeréƒ¨ç½²

```bash
# ä½¿ç”¨Docker Compose
docker-compose up -d --build

# è®¿é—®åº”ç”¨
# å‰ç«¯: http://localhost:3000
# åç«¯: http://localhost:8000
```

## ğŸ”§ é…ç½®è¯´æ˜

### 1. ç¯å¢ƒå˜é‡é…ç½®

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# åç«¯é…ç½®
DATABASE_URL=sqlite:///./data/taskwall.db
GEMINI_API_KEY=your_gemini_api_key_here

# å‰ç«¯é…ç½® (frontend/.env)
VITE_API_BASE_URL=http://localhost:8000
```

### 2. Gemini API å¯†é’¥é…ç½®

**è·å–APIå¯†é’¥**:
1. è®¿é—® [Google AI Studio](https://makersuite.google.com/app/apikey)
2. åˆ›å»ºæ–°çš„APIå¯†é’¥
3. åœ¨åº”ç”¨è®¾ç½®ä¸­è¾“å…¥å¯†é’¥

**è®¾ç½®æ–¹å¼**:
- é€šè¿‡Webç•Œé¢ï¼šè®¾ç½® â†’ AIè®¾ç½® â†’ Gemini API Key
- é€šè¿‡ç¯å¢ƒå˜é‡ï¼š`GEMINI_API_KEY=your_key`
- é€šè¿‡é…ç½®æ–‡ä»¶ï¼šåœ¨æ•°æ®åº“settingsè¡¨ä¸­ä¿å­˜

### 3. æ•°æ®åº“é…ç½®

**é»˜è®¤é…ç½®** (SQLite):
```python
DATABASE_URL = "sqlite:///./data/taskwall.db"
```

**PostgreSQLé…ç½®** (å¯é€‰):
```python
DATABASE_URL = "postgresql://user:password@localhost/taskwall"
```

**MySQLé…ç½®** (å¯é€‰):
```python
DATABASE_URL = "mysql://user:password@localhost/taskwall"
```

## ğŸ“ ç›®å½•ç»“æ„

```
TaskWall/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ data/              # SQLiteæ•°æ®åº“æ–‡ä»¶
â”‚   â””â”€â”€ requirements.txt
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ dist/              # æ„å»ºè¾“å‡ºç›®å½•
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ data/                  # å…±äº«æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ taskwall.db        # ä¸»æ•°æ®åº“
â”‚   â””â”€â”€ backup/            # è‡ªåŠ¨å¤‡ä»½æ–‡ä»¶
â”œâ”€â”€ docker-compose.yml     # Dockerç¼–æ’æ–‡ä»¶
â””â”€â”€ start.sh              # å¯åŠ¨è„šæœ¬
```

## ğŸŒ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### 1. å‰ç«¯æ„å»º

```bash
cd frontend
npm run build

# è¾“å‡ºç›®å½•: dist/
# å¯éƒ¨ç½²åˆ°ä»»ä½•é™æ€æ–‡ä»¶æœåŠ¡å™¨
```

### 2. Nginxé…ç½®

```nginx
server {
    listen 80;
    server_name yourdomain.com;

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /path/to/taskwall/frontend/dist;
        try_files $uri $uri/ /index.html;
    }

    # åç«¯APIä»£ç†
    location /api {
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

### 3. åç«¯ç”Ÿäº§é…ç½®

**ä½¿ç”¨Gunicorn**:
```bash
pip install gunicorn
gunicorn app.main:app -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000
```

**ä½¿ç”¨PM2** (Node.jsè¿›ç¨‹ç®¡ç†å™¨):
```bash
npm install -g pm2
pm2 start "gunicorn app.main:app -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000" --name taskwall-api
```

### 4. ç³»ç»ŸæœåŠ¡é…ç½®

**åˆ›å»ºsystemdæœåŠ¡** (`/etc/systemd/system/taskwall.service`):
```ini
[Unit]
Description=TaskWall API Server
After=network.target

[Service]
Type=exec
User=taskwall
Group=taskwall
WorkingDirectory=/opt/taskwall/backend
Environment=PATH=/opt/taskwall/backend/venv/bin
ExecStart=/opt/taskwall/backend/venv/bin/gunicorn app.main:app -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000
Restart=always

[Install]
WantedBy=multi-user.target
```

å¯åŠ¨æœåŠ¡ï¼š
```bash
sudo systemctl enable taskwall
sudo systemctl start taskwall
sudo systemctl status taskwall
```

## ğŸ”’ å®‰å…¨é…ç½®

### 1. HTTPSé…ç½®

**Let's Encrypt SSLè¯ä¹¦**:
```bash
sudo certbot --nginx -d yourdomain.com
```

**SSLé…ç½®æ›´æ–°**:
```nginx
server {
    listen 443 ssl http2;
    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;
    
    # å…¶ä»–é…ç½®...
}
```

### 2. é˜²ç«å¢™é…ç½®

```bash
# å¼€æ”¾å¿…è¦ç«¯å£
sudo ufw allow 22   # SSH
sudo ufw allow 80   # HTTP
sudo ufw allow 443  # HTTPS
sudo ufw enable
```

### 3. å®‰å…¨å¤´é…ç½®

```nginx
# å®‰å…¨å¤´
add_header X-Frame-Options DENY;
add_header X-Content-Type-Options nosniff;
add_header X-XSS-Protection "1; mode=block";
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains";
```

## ğŸ“Š ç›‘æ§é…ç½®

### 1. åº”ç”¨ç›‘æ§

**ä½¿ç”¨Prometheus + Grafana**:
```bash
# å®‰è£…ç›‘æ§ä¾èµ–
pip install prometheus-client

# æ·»åŠ ç›‘æ§ç«¯ç‚¹åˆ°FastAPIåº”ç”¨
from prometheus_client import generate_latest, Counter, Histogram
```

### 2. æ—¥å¿—é…ç½®

**é…ç½®Pythonæ—¥å¿—**:
```python
import logging
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('/var/log/taskwall/app.log'),
        logging.StreamHandler()
    ]
)
```

### 3. å¥åº·æ£€æŸ¥

**æ·»åŠ å¥åº·æ£€æŸ¥ç«¯ç‚¹**:
```python
@app.get("/health")
async def health_check():
    return {
        "status": "healthy",
        "timestamp": datetime.utcnow(),
        "version": "2.0.0"
    }
```

## ğŸ”„ å¤‡ä»½ä¸æ¢å¤

### 1. è‡ªåŠ¨å¤‡ä»½é…ç½®

**æ•°æ®åº“å¤‡ä»½**:
```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬ (/opt/taskwall/backup.sh)
#!/bin/bash
BACKUP_DIR="/opt/taskwall/backups"
DATE=$(date +%Y%m%d_%H%M%S)

# æ•°æ®åº“å¤‡ä»½
cp /opt/taskwall/data/taskwall.db $BACKUP_DIR/taskwall_$DATE.db

# æ¸…ç†30å¤©å‰çš„å¤‡ä»½
find $BACKUP_DIR -name "taskwall_*.db" -mtime +30 -delete
```

**å®šæ—¶å¤‡ä»½ä»»åŠ¡**:
```bash
# æ·»åŠ åˆ°crontab
0 2 * * * /opt/taskwall/backup.sh
```

### 2. æ¢å¤æ“ä½œ

```bash
# åœæ­¢æœåŠ¡
sudo systemctl stop taskwall

# æ¢å¤æ•°æ®åº“
cp /opt/taskwall/backups/taskwall_backup.db /opt/taskwall/data/taskwall.db

# é‡å¯æœåŠ¡
sudo systemctl start taskwall
```

## ğŸ› æ•…éšœæ’é™¤

### 1. å¸¸è§é—®é¢˜

**ç«¯å£å ç”¨**:
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :8000
lsof -i :5173

# ç»ˆæ­¢å ç”¨è¿›ç¨‹
kill -9 <PID>
```

**æƒé™é—®é¢˜**:
```bash
# ä¿®å¤æ–‡ä»¶æƒé™
sudo chown -R taskwall:taskwall /opt/taskwall
sudo chmod +x /opt/taskwall/start.sh
```

**ä¾èµ–å®‰è£…é—®é¢˜**:
```bash
# Pythonä¾èµ–é—®é¢˜
pip install --upgrade pip
pip install -r requirements.txt --force-reinstall

# Node.jsä¾èµ–é—®é¢˜
rm -rf node_modules package-lock.json
npm install
```

### 2. æ—¥å¿—æ£€æŸ¥

```bash
# åº”ç”¨æ—¥å¿—
tail -f /var/log/taskwall/app.log

# ç³»ç»ŸæœåŠ¡æ—¥å¿—
journalctl -u taskwall -f

# Nginxæ—¥å¿—
tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log
```

### 3. æ€§èƒ½è°ƒä¼˜

**æ•°æ®åº“ä¼˜åŒ–**:
```sql
-- åˆ›å»ºç´¢å¼•æå‡æŸ¥è¯¢æ€§èƒ½
CREATE INDEX idx_tasks_updated_at ON task(updated_at);
CREATE INDEX idx_tasks_module_id ON task(module_id);
CREATE INDEX idx_tasks_urgency ON task(urgency);
```

**ç¼“å­˜é…ç½®**:
```python
# ä½¿ç”¨Redisç¼“å­˜AIå“åº”
import redis
redis_client = redis.Redis(host='localhost', port=6379, db=0)
```

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

### 1. åŠŸèƒ½å¼€å…³

```python
# åœ¨settingsè¡¨ä¸­é…ç½®åŠŸèƒ½å¼€å…³
FEATURE_FLAGS = {
    "enable_ai_assistant": True,
    "enable_similarity_detection": True,
    "enable_risk_radar": True,
    "enable_theme_islands": True,
    "enable_workload_analysis": True
}
```

### 2. AIæ¨¡å‹é…ç½®

```python
# æ”¯æŒåˆ‡æ¢ä¸åŒçš„AIæ¨¡å‹
AI_CONFIG = {
    "provider": "gemini",  # gemini, openai, claude
    "model": "gemini-pro",
    "temperature": 0.7,
    "max_tokens": 2048
}
```

### 3. ç•Œé¢å®šåˆ¶

```css
/* è‡ªå®šä¹‰ä¸»é¢˜è‰²å½© */
:root {
  --primary-color: #1890ff;
  --success-color: #52c41a;
  --warning-color: #faad14;
  --error-color: #ff4d4f;
}
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **æ–‡æ¡£**: å‚è€ƒé¡¹ç›®READMEå’ŒæŠ€æœ¯æ–‡æ¡£
- **æ—¥å¿—**: æ£€æŸ¥åº”ç”¨å’Œç³»ç»Ÿæ—¥å¿—
- **ç›‘æ§**: ä½¿ç”¨ç›‘æ§å·¥å…·æ’æŸ¥æ€§èƒ½é—®é¢˜
- **ç¤¾åŒº**: æœç´¢ç›¸å…³æŠ€æœ¯ç¤¾åŒºè·å–å¸®åŠ©

---

**TaskWall v2.0** éƒ¨ç½²å®Œæˆåï¼Œæ‚¨å°†æ‹¥æœ‰ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„AIå¢å¼ºå‹ä»»åŠ¡ç®¡ç†ç³»ç»Ÿï¼ ğŸ‰